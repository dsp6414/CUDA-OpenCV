Training Custom Object Detector - TensorFlow Object Detection API Tutorial p.5
https://www.youtube.com/watch?v=JR8CmWyh2E8

Intro - TensorFlow Object Detection API Tutorial p.1
https://www.youtube.com/watch?v=COlbP62-B-U




python env


sudo apt-get install -y build-essential libssl-dev libffi-dev python-dev

sudo apt install -y python3-venv




cd ~

mkdir environment_directory
cd environment_directory

python3 -m venv train_environment



Enter with 
source train_environment/bin/activate

pip3 install pandas
pip3 install tensorflow
pip3 install pil
pip3 install tqdm
pip3 install object_detection
pip3 install sklearn
pip3 install pycocotools
pip3 install nets

sudo apt  install protobuf-compiler


Exit with 
deactivate








#https://gist.github.com/douglasrizzo/c70e186678f126f1b9005ca83d8bd2ce

cd ~

git clone https://github.com/douglasrizzo/detection_util_scripts.git

pip install pandas
pip install sklearn

echo "Copy annotated images from USB"
cp -r /media/$USER/CUDA/salmon/ ~/


cd detection_util_scripts

python3 generate_csv.py xml /home/$USER/salmon salmon.csv

python3 generate_train_eval.py salmon.csv

python3 generate_pbtxt.py csv salmon.csv salmon_label_map.pbtxt



python3 generate_tfrecord.py salmon_train.csv salmon_label_map.pbtxt /home/$USER/salmon ./salmon_train.tfrecords
python3 generate_tfrecord.py salmon_eval.csv salmon_label_map.pbtxt /home/$USER/salmon ./salmon_eval.tfrecords


wget http://download.tensorflow.org/models/object_detection/ssd_mobilenet_v1_coco_2018_01_28.tar.gz

wget http://download.tensorflow.org/models/object_detection/ssd_mobilenet_v2_coco_2018_03_29.tar.gz

tar xvzf ssd_mobilenet_v2_coco_2018_03_29.tar.gz

tar xvzf ssd_mobilenet_v1_coco_2018_01_28.tar.gz



tar xvzf ssd_inception_v2_coco_2018_01_28.tar.gz


/home/jarleven/detection_util_scripts/salmon.ckpt


/home/jarleven/detection_util_scripts/salmon_label_map.pbtxt
/home/jarleven/detection_util_scripts/salmon_eval.tfrecords
/home/jarleven/detection_util_scripts/salmon_train.tfrecords




/home/jarleven/detection_util_scripts/ssd_mobilenet_v2_coco_2018_03_29/model.ckpt.data-00000-of-00001 





  fine_tune_checkpoint: "PATH_TO_BE_CONFIGURED/model.ckpt"
  from_detection_checkpoint: true
  num_steps: 200000
}
train_input_reader {
  label_map_path: "PATH_TO_BE_CONFIGURED/mscoco_label_map.pbtxt"
  tf_record_input_reader {
    input_path: "PATH_TO_BE_CONFIGURED/mscoco_train.record"
  }
}
eval_config {
  num_examples: 8000
  max_evals: 10
  use_moving_averages: false
}
eval_input_reader {
  label_map_path: "PATH_TO_BE_CONFIGURED/mscoco_label_map.pbtxt"
  shuffle: false
  num_readers: 1
  tf_record_input_reader {
    input_path: "PATH_TO_BE_CONFIGURED/mscoco_val.record"
  }




~/detection_util_scripts/pipeline.config

cd ~/models/research

/home/jarleven/detection_util_scripts/ssd_mobilenet_v2_coco_2018_03_29/pipeline.config


PIPELINE_CONFIG_PATH=/home/jarleven/detection_util_scripts/ssd_mobilenet_v2_coco_2018_03_29/pipeline.config

PIPELINE_CONFIG_PATH=/home/jarleven/detection_util_scripts/ssd_inception_v2_coco_2018_01_28/pipeline.config
MODEL_DIR=/home/jarleven/salmon_model
NUM_TRAIN_STEPS=50000
SAMPLE_1_OF_N_EVAL_EXAMPLES=1
python3 object_detection/model_main.py \
    --pipeline_config_path=${PIPELINE_CONFIG_PATH} \
    --model_dir=${MODEL_DIR} \
    --num_train_steps=${NUM_TRAIN_STEPS} \
    --sample_1_of_n_eval_examples=$SAMPLE_1_OF_N_EVAL_EXAMPLES \
    --alsologtostderr





INPUT_TYPE=image_tensor
PIPELINE_CONFIG_PATH=~/detection_util_scripts/ssd_mobilenet_v1_coco_2018_01_28/pipeline.config
TRAINED_CKPT_PREFIX=/home/jarleven/detection_util_scripts/ssd_inception_v2_coco_2018_01_28/model.ckpt

EXPORT_DIR=~/salmon_model/
python object_detection/export_tflite_ssd_graph.py \
    --input_type=${INPUT_TYPE} \
    --pipeline_config_path=${PIPELINE_CONFIG_PATH} \
    --trained_checkpoint_prefix=${TRAINED_CKPT_PREFIX} \
    --output_directory=${EXPORT_DIR}



python export_inference_graph.py --input_type image_tensor --pipeline_config_path ~/detection_util_scripts/ssd_mobilenet_v1_coco_2018_01_28/pipeline.configg --trained_checkpoint_prefix ~/detection_util_scripts/ssd_mobilenet_v1_coco_2018_01_28/model.ckpt --output_directory ~/salmon_model

python export_inference_graph.py --input_type image_tensor --pipeline_config_path ssd_mobilenet_v1_coco.config --trained_checkpoint_prefix models\model.ckpt-1000 --output_directory tuned_model


git clone https://github.com/tensorflow/models.git


# From tensorflow/models/research/
protoc object_detection/protos/*.proto --python_out=.

(train_environment) jarleven@stue:~/models/research$ protoc object_detection/protos/*.proto --python_out=.

(train_environment) jarleven@stue:~/models/research$ export PYTHONPATH=$PYTHONPATH:`pwd`:`pwd`/slim                                                                        


(train_environment) jarleven@stue:~/models/research$ python3 setup.py build

(train_environment) jarleven@stue:~/models/research$ python3 setup.py install


(train_environment) jarleven@stue:~/models/research$ python3 object_detection/model_main.py     --pipeline_config_path=${PIPELINE_CONFIG_PATH}     --model_dir=${MODEL_DIR}     --num_train_steps=${NUM_TRAIN_STEPS}     --sample_1_of_n_eval_examples=$SAMPLE_1_OF_N_EVAL_EXAMPLES     --alsologtostderr




generate_tfrecord.py: error: the following arguments are required: csv_input, pbtxt_input, image_dir, output_path





The Mythical Man-Month, Engelsk, 1995
Forfatter: Frederick P. Brooks Jr.